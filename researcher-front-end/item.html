<!doctype html>
<head>
  <meta charset="utf-8">

  <title>DigiDig: Research</title>
  <meta name="description" content="My Parse App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/styles.css">
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</head>

<body>
  <div id="container-item">
    <h1 id="title"></h1>
    <br>
  </div>

  <script type="text/javascript">
    Parse.initialize("EfLjLMR7WNu4EXtszi483xKZDrsK0n3OB7D5Bdea", "bZ6wJgfR9sulzlnrnN3sRawM5pFIzkgStHC76KDc");
    
    var DigDig = Parse.Object.extend("DigDig");
    var query = new Parse.Query(DigDig);
    var id = getParameterByName("id");
    query.equalTo("PaleoID", id);

    query.find({
      success: function(results) {
        document.getElementById('title').innerText = results[0].get('Title');

        var list = document.createElement('ul');

        if (results[0].get('ImgArray') != undefined) {
          document.getElementById('container-item').appendChild(document.createElement('h1').appendChild(document.createTextNode("Image Array: ")));
          for (var i = 0; i < results.length; i++) {
            var object = results[i];
            var item = document.createElement('li');
            item.appendChild(document.createTextNode(object.get('ImgArray') + " (reported by " + object.get('UserEmail') + ")."))
            list.appendChild(item);
          }
          document.getElementById('container-item').appendChild(list);
        }
      },
      error: function(error) {
        alert("Error: " + error.code + " " + error.message);
      }
    });


    function getParameterByName(name) {
      name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
      var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
      results = regex.exec(location.search);
      return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
  </script>
</body>

</html>